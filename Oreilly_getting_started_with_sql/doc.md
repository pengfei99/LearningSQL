# Use sqlite server in linux

## Install sqlite server in ubuntu
```shell
sudo apt-get install sqlite3
```

## Open a sqlite db

sqlite store tables in a file .db. To open a database, you just need to provide the path of the file. Below is an
example

```shell
sqlite3 database/rexon_metals.db

# now you have a sqlite terminal
sqlite> .tables
BEHIND_SCHEDULE   CUSTOMER_ORDER    PRODUCT         
CUSTOMER          CUSTOMER_REVENUE

```

Note sqlite terminal only supports sqlite command or sql commands

## Create a sql dump, so you can import the db to other database server

```sqlite
-- specify the output path of your dump
.OUTPUT /tmp/rexon_metals.sql
-- dump the database
.DUMP 

-- without argument, it will dump all tables in the database, if you give a name of table. It only dump the table

-- exit the sqlite terminal
.EXIT 
```

## The dump sql file is not standard

The dump sql file generated by sqlite has many bugs. For example, below is a raw dump of **rexon_metals.db** 

```sql
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE PRODUCT (PRODUCT_ID INTEGER PRIMARY KEY AUTOINCREMENT, DESCRIPTION TEXT, PRICE DECIMAL);
INSERT INTO PRODUCT VALUES(1,'Copper',7.5099999999999997868);
INSERT INTO PRODUCT VALUES(2,'Aluminum',2.580000000000000071);
INSERT INTO PRODUCT VALUES(3,'Silver',15);
INSERT INTO PRODUCT VALUES(4,'Steel',12.310000000000000496);
INSERT INTO PRODUCT VALUES(5,'Bronze',4);
INSERT INTO PRODUCT VALUES(6,'Duralumin',7.5999999999999996447);
INSERT INTO PRODUCT VALUES(7,'Solder',14.160000000000000142);
INSERT INTO PRODUCT VALUES(8,'Stellite',13.310000000000000497);
INSERT INTO PRODUCT VALUES(9,'Brass',4.75);
CREATE TABLE CUSTOMER (CUSTOMER_ID INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, NAME TEXT NOT NULL, REGION TEXT, STREET_ADDRESS TEXT, CITY TEXT, STATE TEXT, ZIP INTEGER);
INSERT INTO CUSTOMER VALUES(1,'LITE Industrial','Southwest','729 Ravine Way','Irving','TX',75014);
INSERT INTO CUSTOMER VALUES(2,'Rex Tooling Inc','Southwest','6129 Collie Blvd','Dallas','TX',75201);
INSERT INTO CUSTOMER VALUES(3,'Re-Barre Construction','Southwest','9043 Windy Dr','Irving','TX',75032);
INSERT INTO CUSTOMER VALUES(4,'Prairie Construction','Southwest','264 Long Rd','Moore','OK',62104);
INSERT INTO CUSTOMER VALUES(5,'Marsh Lane Metal Works','Southeast','9143 Marsh Ln','Avondale','LA',79782);
CREATE TABLE CUSTOMER_ORDER (ORDER_ID INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, ORDER_DATE DATE NOT NULL, SHIP_DATE DATE, CUSTOMER_ID INTEGER REFERENCES CUSTOMER (CUSTOMER_ID) NOT NULL, PRODUCT_ID INTEGER REFERENCES PRODUCT (PRODUCT_ID) NOT NULL, ORDER_QTY INTEGER NOT NULL, SHIPPED BOOLEAN NOT NULL DEFAULT (0));
INSERT INTO CUSTOMER_ORDER VALUES(1,'2015-05-15','2015-05-18',1,1,450,'false');
INSERT INTO CUSTOMER_ORDER VALUES(2,'2015-05-18','2015-05-21',3,2,600,'false');
INSERT INTO CUSTOMER_ORDER VALUES(3,'2015-05-20','2015-05-23',3,5,300,'false');
INSERT INTO CUSTOMER_ORDER VALUES(4,'2015-05-18','2015-05-22',5,4,375,'false');
INSERT INTO CUSTOMER_ORDER VALUES(5,'2015-05-17','2015-05-20',3,2,500,'false');
DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('PRODUCT',9);
INSERT INTO sqlite_sequence VALUES('CUSTOMER',5);
INSERT INTO sqlite_sequence VALUES('CUSTOMER_ORDER',5);
CREATE VIEW BEHIND_SCHEDULE AS SELECT * FROM CUSTOMER_ORDER 

WHERE SHIP_DATE < date('now')
AND SHIPPED = 'false';
CREATE VIEW CUSTOMER_REVENUE AS SELECT NAME, SUM(ORDER_QTY * PRICE) AS REVENUE FROM CUSTOMER INNER JOIN CUSTOMER_ORDER ON CUSTOMER.CUSTOMER_ID = CUSTOMER_ORDER.CUSTOMER_ID INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = CUSTOMER_ORDER.PRODUCT_ID GROUP BY NAME;
COMMIT;
```

### Error 1

Line 1 need to be removed, it's not a sql statement
```text
PRAGMA foreign_keys=OFF;
```

### Error 2 

For declaring the auto increment primary key in a db, sqlite use keyword "AUTOINCREMENT". 

#### Mysql
But Mysql use keyword "AUTO_INCREMENT". Below is an example

```sql
CREATE TABLE Persons (
    Personid int NOT NULL AUTO_INCREMENT,
    LastName varchar(255) NOT NULL,
    FirstName varchar(255),
    Age int,
    PRIMARY KEY (Personid)
);
```

#### Postgresql
Postgresql does not support "AUTOINCREMENT" at all. For integer "AUTOINCREMENT", you need to convert it to type "serial"

You'll also want to check for datetime columns in the SQLite schema and change them to timestamp for PostgreSQL

### Error 3

For **boolean type**, If you have booleans in your SQLite dump and you want to import it into postgresql, then you need to 
convert 1 and 0 to 1::boolean and 0::boolean(respectively).

you could change the boolean column to an integer in the schema section of the dump and then fix them up by hand inside PostgreSQL after the import.